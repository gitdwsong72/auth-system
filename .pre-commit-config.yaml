# Pre-commit Hooks Configuration
# Install: pip install pre-commit && pre-commit install
#
# 커밋 전 자동 실행되는 검증 단계:
# 1. Ruff (linting + formatting)
# 2. MyPy (type checking)
# 3. 테스트 (빠른 단위 테스트만)

repos:
  # Ruff - Fast Python linter & formatter
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.4.0
    hooks:
      # Linting (disabled for pre-commit speed, enabled in CI)
      # - id: ruff
      #   args: [--fix]
      #   name: Ruff Linting
      #   description: "Fast Python linter (replaces flake8, isort, etc.)"
      #   files: ^auth-service/

      # Formatting
      - id: ruff-format
        name: Ruff Formatting
        description: "Fast Python formatter (replaces black)"
        files: ^auth-service/

  # MyPy - Static type checking (disabled for pre-commit, enabled in CI)
  # - repo: https://github.com/pre-commit/mirrors-mypy
  #   rev: v1.10.0
  #   hooks:
  #     - id: mypy
  #       name: MyPy Type Checking
  #       additional_dependencies:
  #         - "types-redis"
  #         - "types-python-jose"
  #       args: [--config-file=auth-service/pyproject.toml]
  #       files: ^auth-service/src/
  #       exclude: ^auth-service/tests/

  # Security - Check for common security issues (disabled for pre-commit, enabled in CI)
  # - repo: https://github.com/PyCQA/bandit
  #   rev: 1.7.8
  #   hooks:
  #     - id: bandit
  #       name: Bandit Security Scan
  #       args: [-c, auth-service/pyproject.toml, -r, auth-service/src/]
  #       additional_dependencies: ["bandit[toml]"]
  #       files: ^auth-service/src/
  #       pass_filenames: false

  # Trailing whitespace & EOF
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
        name: Trim trailing whitespace
      - id: end-of-file-fixer
        name: Fix end of files
      - id: check-yaml
        name: Check YAML syntax
      - id: check-added-large-files
        args: [--maxkb=500]
        name: Check for large files

  # Fast unit tests (optional - comment out if too slow)
  # - repo: local
  #   hooks:
  #     - id: pytest-fast
  #       name: Fast Unit Tests
  #       entry: bash -c 'cd auth-service && pytest tests/unit/ -x --tb=short -q'
  #       language: system
  #       pass_filenames: false
  #       always_run: true
  #       stages: [pre-commit]
