# Backpressure (과부하 방지) 설정 예시

## Development (로컬 개발)
# 낮은 트래픽, 빠른 피드백
BACKPRESSURE_ENABLE_BACKPRESSURE=false  # 개발 중에는 비활성화
BACKPRESSURE_MAX_CONCURRENT=20
BACKPRESSURE_QUEUE_CAPACITY=100
BACKPRESSURE_WAIT_TIMEOUT=10.0

## Staging (테스트 환경)
# 실제 운영 환경 시뮬레이션, 부하 테스트
# BACKPRESSURE_ENABLE_BACKPRESSURE=true
# BACKPRESSURE_MAX_CONCURRENT=80
# BACKPRESSURE_QUEUE_CAPACITY=500
# BACKPRESSURE_WAIT_TIMEOUT=5.0

## Production (프로덕션)
# 고가용성, 시스템 안정성 우선
# BACKPRESSURE_ENABLE_BACKPRESSURE=true
# BACKPRESSURE_MAX_CONCURRENT=100
# BACKPRESSURE_QUEUE_CAPACITY=1000
# BACKPRESSURE_WAIT_TIMEOUT=3.0
# BACKPRESSURE_REJECT_THRESHOLD=1100

## 임계치 계산 가이드
# 1. DB Connection Pool 기반 (권장)
#    max_concurrent = DB_POOL_MAX_SIZE × 0.8
#    예시: DB Pool 100개 → max_concurrent=80
#
# 2. CPU 기반
#    max_concurrent = workers × concurrent_per_worker × 0.7
#    예시: 4 workers × 100 tasks × 0.7 = 280
#
# 3. Response Time 기반 (Little's Law)
#    max_concurrent = target_rps × avg_response_time_seconds
#    예시: 1000 RPS × 0.05s = 50
#
# 가장 제한적인 값을 선택!

## Queue Capacity 계산
# queue_capacity = max_concurrent × buffer_seconds
# 예시: 100 req/s × 10s = 1000

## Wait Timeout 권장값
# - 사용자 경험: 3-5초 (프로덕션 권장)
# - 배치 작업: 10-30초
# - 즉시 거부: 0.5-1초

## Reject Threshold
# 기본값: max_concurrent + queue_capacity
# 즉시 거부 원하면: max_concurrent × 1.1 (10% 버퍼만)
